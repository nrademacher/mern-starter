var e=Object.defineProperty,t=Object.prototype.hasOwnProperty,r=Object.getOwnPropertySymbols,n=Object.prototype.propertyIsEnumerable,a=(t,r,n)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[r]=n,l=(e,l)=>{for(var s in l||(l={}))t.call(l,s)&&a(e,s,l[s]);if(r)for(var s of r(l))n.call(l,s)&&a(e,s,l[s]);return e};import{w as s,u as o,r as c,R as u,a as m,b as i,o as E,c as p,L as d,S as h,P as w,H as f,d as v,e as b,f as g,t as y,l as R,g as S}from"./vendor.53ae43a9.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(r){const n=new URL(e,location),a=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((r,l)=>{const s=new URL(e,n);if(self[t].moduleMap[s])return r(self[t].moduleMap[s]);const o=new Blob([`import * as m from '${s}';`,`${t}.moduleMap['${s}']=m;`],{type:"text/javascript"}),c=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(o),onerror(){l(new Error(`Failed to import: ${e}`)),a(c)},onload(){r(self[t].moduleMap[s]),a(c)}});document.head.appendChild(c)})),self[t].moduleMap={}}}("/assets/");const C=s((({component:e,path:t,exact:r})=>{const n=o((e=>e.session.isAuthenticated));return c.createElement(u,{path:t,exact:r,render:t=>n?c.createElement(m,{to:"/tweets"}):c.createElement(e,l({},t))})})),_=s((e=>{var{component:a}=e,s=((e,a)=>{var l={};for(var s in e)t.call(e,s)&&a.indexOf(s)<0&&(l[s]=e[s]);if(null!=e&&r)for(var s of r(e))a.indexOf(s)<0&&n.call(e,s)&&(l[s]=e[s]);return l})(e,["component"]);const i=o((e=>e.session.isAuthenticated));return c.createElement(u,l(l({},s),{render:e=>i?c.createElement(a,l({},e)):c.createElement(m,{to:"/login"})}))})),T=e=>{e?i.defaults.headers.common.Authorization=e:delete i.defaults.headers.common.Authorization},x=e=>({type:"RECEIVE_SESSION_ERRORS",errors:e}),I=e=>t=>{return(r=e,i.post("http://localhost:5000/api/users/register",r)).then((()=>t({type:"RECEIVE_USER_SIGN_IN"})),(e=>t(x(e.response.data))));var r},O=e=>t=>{return(r=e,i.post("http://localhost:5000/api/users/login",r)).then((e=>{const{token:r}=e.data;localStorage.setItem("jwtToken",r),T(r);const n=E(r);t({type:"RECEIVE_CURRENT_USER",currentUser:n})})).catch((e=>{t(x(e.response.data))}));var r},j=()=>e=>{localStorage.removeItem("jwtToken"),T(!1),e({type:"RECEIVE_USER_LOGOUT"})},U=()=>{const e=c.useRef(null),[t,r]=c.useState("bordered"),n=o((e=>e.session.isAuthenticated)),a=p(),l=e=>{e.preventDefault(),a(j()),r("bordered")},s=n=>{t&&r(""),e.current&&e.current.classList.remove("bordered"),e.current=n.currentTarget,n.currentTarget.classList.add("bordered")};return c.createElement("nav",{className:"mx-auto w-full text-center"},n?c.createElement("ul",{className:"px-3 flex w-full shadow-lg menu horizontal"},c.createElement("li",{className:`justify-self-start ${t}`,onClick:e=>s(e)},c.createElement(d,{to:"/tweets"},"All Tweets")),c.createElement("li",{className:"justify-self-start",onClick:e=>s(e)},c.createElement(d,{to:"/profile"},"Profile")),c.createElement("li",{className:"flex-1",onClick:e=>s(e)},c.createElement(d,{to:"/new_tweet"},"Write a Tweet")),c.createElement("li",{onClick:e=>s(e),className:"justify-self-end self-center h-full"},c.createElement("button",{onClick:l,className:"btn btn-primary btn-md border"},"Logout"))):c.createElement("div",null,c.createElement(d,{to:"/signup"},"Signup"),c.createElement(d,{to:"/login"},"Login")))};class N extends c.Component{render(){return c.createElement("div",null,c.createElement("h3",null,this.props.text))}}const k=()=>e=>i.get("http://localhost:5000/api/tweets").then((t=>e((e=>({type:"RECEIVE_TWEETS",tweets:e}))(t)))).catch((e=>console.log(e))),L=e=>t=>(e=>i.get(`http://localhost:5000/api/tweets/user/${e}`))(e).then((e=>t((e=>({type:"RECEIVE_USER_TWEETS",tweets:e}))(e)))).catch((e=>console.log(e))),V=e=>t=>(e=>i.post("http://localhost:5000/api/tweets/",e))(e).then((e=>t((e=>({type:"RECEIVE_NEW_TWEET",tweet:e}))(e)))).catch((e=>console.log(e)));var A=s((()=>{const e=o((e=>Object.values(e.tweets.all))),t=p();return c.useEffect((()=>{t(k())}),[t]),0===e.length?c.createElement("div",null,"There are no Tweets"):c.createElement("div",null,c.createElement("h2",null,"All Tweets"),e.map((e=>c.createElement(N,{key:e._id,text:e.text}))))}));class W extends c.Component{render(){return c.createElement("div",null,c.createElement("p",null,"A Twitter Clone"),c.createElement("footer",null,"Copyright Â© 2019 Chirper"))}}var P=s((e=>{const[t,r]=c.useState({email:"",password:""}),n=o((e=>e.errors.session)),a=p(),s=e=>n=>r(l(l({},t),{[e]:n.target.value}));return c.createElement("div",null,c.createElement("form",{onSubmit:e=>{e.preventDefault();let r={email:t.email,password:t.password};a(O(r))}},c.createElement("div",null,c.createElement("br",null),c.createElement("input",{type:"text",value:t.email,onChange:s("email"),placeholder:"Email"}),c.createElement("br",null),c.createElement("input",{type:"password",value:t.password,onChange:s("password"),placeholder:"Password"}),c.createElement("br",null),c.createElement("input",{type:"submit",value:"Submit"}),c.createElement("ul",null,Object.keys(n).map(((e,t)=>c.createElement("li",{key:`error-${t}`},n[e])))))))}));var $=s((e=>{const t=o((e=>e.session.isSignedIn)),r=o((e=>e.errors.session)),n=p(),[a,s]=c.useState({email:"",handle:"",password:"",password2:""}),{history:u}=e;c.useEffect((()=>{t&&u.push("/login")}),[t,u]);const m=e=>t=>s(l(l({},a),{[e]:t.currentTarget.value}));return c.createElement("div",{className:"login-form-container"},c.createElement("form",{onSubmit:e=>{e.preventDefault();let t={email:a.email,handle:a.handle,password:a.password,password2:a.password2};n(I(t))}},c.createElement("div",{className:"login-form"},c.createElement("br",null),c.createElement("input",{type:"text",value:a.email,onChange:m("email"),placeholder:"Email"}),c.createElement("br",null),c.createElement("input",{type:"text",value:a.handle,onChange:m("handle"),placeholder:"Handle"}),c.createElement("br",null),c.createElement("input",{type:"password",value:a.password,onChange:m("password"),placeholder:"Password"}),c.createElement("br",null),c.createElement("input",{type:"password",value:a.password2,onChange:m("password2"),placeholder:"Confirm Password"}),c.createElement("br",null),c.createElement("input",{type:"submit",value:"Submit"}),c.createElement("ul",null,Object.keys(r).map(((e,t)=>c.createElement("li",{key:`error-${t}`},r[e])))))))}));const D=()=>{const e=o((e=>Object.values(e.tweets.user))),t=o((e=>e.session.user)),r=p();return c.useEffect((()=>{console.log(t.id),r(L(t.id))}),[t,r]),0===e.length?c.createElement("div",null,"This user has no Tweets"):c.createElement("div",null,c.createElement("h2",null,"All of This User's Tweets"),e.map((e=>c.createElement(N,{key:e._id,text:e.text}))))},M=e=>{const t=p(),[r,n]=c.useState("");return c.createElement("div",null,c.createElement("form",{onSubmit:e=>{e.preventDefault(),t(V({text:r})),n("")}},c.createElement("div",null,c.createElement("input",{type:"textarea",value:r,onChange:e=>{n(e.currentTarget.value)},placeholder:"Write your tweet..."}),c.createElement("input",{type:"submit",value:"Submit"}))),c.createElement("br",null),c.createElement(N,{text:r}))},z=()=>c.createElement("div",{className:"mx-auto min-h-screen bg-base-100 text-primary-content"},c.createElement(U,null),c.createElement(h,null,c.createElement(C,{exact:!0,path:"/",component:W}),c.createElement(C,{exact:!0,path:"/login",component:P}),c.createElement(C,{exact:!0,path:"/signup",component:$}),c.createElement(_,{exact:!0,path:"/tweets",component:A}),c.createElement(_,{exact:!0,path:"/profile",component:D}),c.createElement(_,{exact:!0,path:"/new_tweet",component:M}))),G=({store:e})=>c.createElement(w,{store:e},c.createElement(f,null,c.createElement(z,null))),B={isAuthenticated:!1,user:{}};const F=[];var H=v({session:(e=F,t)=>{switch(Object.freeze(e),t.type){case"RECEIVE_SESSION_ERRORS":return t.errors;case"RECEIVE_CURRENT_USER":return F;default:return e}}});const q=v({errors:H,session:function(e=B,t){switch(t.type){case"RECEIVE_CURRENT_USER":return l(l({},e),{isAuthenticated:!!t.currentUser,user:t.currentUser});case"RECEIVE_USER_LOGOUT":return{isAuthenticated:!1,user:void 0};case"RECEIVE_USER_SIGN_IN":return l(l({},e),{isSignedIn:!0});default:return e}},tweets:(e={all:{},user:{},new:void 0},t)=>{Object.freeze(e);let r=Object.assign({},e);switch(t.type){case"RECEIVE_TWEETS":return r.all=t.tweets.data,r;case"RECEIVE_USER_TWEETS":return r.user=t.tweets.data,r;case"RECEIVE_NEW_TWEET":return r.new=t.tweet.data,r;default:return e}}}),J=(e={})=>b(q,e,g(y,R));document.addEventListener("DOMContentLoaded",(()=>{let e;if(localStorage.jwtToken){T(localStorage.jwtToken);const t=E(localStorage.jwtToken);e=J({session:{isAuthenticated:!0,user:t}});const r=Date.now()/1e3;t.exp<r&&(e.dispatch(j()),window.location.href="/login")}else e=J({});const t=document.getElementById("root");S.render(c.createElement(G,{store:e}),t)}));
